<ion-header>
</ion-header>

<ion-content>
  <ion-grid>
    <ion-row>
      <ion-col size="12" size-sm="8" offset-sm="2" text-center>
        <ion-card color="medium">
          <ion-card-header>
            {{getNumberOfStopsLeft()}}/{{loadedTour.numberOfStops}} Stopps absolviert
            <br>
            Preis: {{loadedTour.price}}€
          </ion-card-header>
        </ion-card>
        <ion-card *ngFor="let stop of loadedTour.tourStop"
                  [color]="stop.stopType==='Depot' ? 'primary' : 'light'">
          <ion-card-header>
            <ion-card-title>
              <ion-icon name="repeat" *ngIf="stop.stopType==='Depot'"></ion-icon>
              <ion-icon name="pin" *ngIf="stop.stopType==='Receiver'"></ion-icon>
              {{ stop.firstName}} {{stop.lastName}},
              {{stop.streetName}} {{stop.streetNumber}},
              {{stop.zip}} {{stop.city}}
            </ion-card-title>
          </ion-card-header>
          <ion-card-content>
            <div *ngIf="stop.stopType==='Receiver'">
                <p>
                  Anzahl der Pakete:{{getParcelData(stop.id).length}}
                </p>
                <p *ngFor="let parcel of getParcelData(stop.id)">
                  <ion-text>Paket-ID: {{parcel.sscc}} </ion-text>
                  <ion-text *ngIf="isParcelLoaded(parcel.depotID)===true" color="success">
                    <ion-icon name="checkmark-circle"></ion-icon>
                    an Bord
                  </ion-text>
                  <ion-text *ngIf="isParcelLoaded(parcel.depotID)===false" color="warning">
                    <ion-icon name="alert"></ion-icon>
                    nicht an Bord
                  </ion-text>
                </p>
                <br>
              <ion-button fill="outline" href="{{getNavigationLink(stop.streetName, stop.streetNumber, stop.zip, stop.city)}}" mode="ios">
                Navigiere
              </ion-button>
              <ion-button fill="outline" [routerLink]="['../../../../receiver-handover', getUndeliveredParcelsOfStop(stop.id)]" mode="ios">
                Übergabe
              </ion-button>
            </div>
            <div *ngIf="stop.stopType==='Depot'">
              <ion-button fill="outline" color="light" href="{{getNavigationLink(stop.streetName, stop.streetNumber, stop.zip, stop.city)}}" mode="ios">
                Navigiere
              </ion-button>
              <ion-button fill="outline" color="light" [routerLink]="['../../../../depot-handover', 23423]" mode="ios"> <!-- TODO -->
                Abholung
              </ion-button>
            </div>
            <!--<p *ngIf="stop.stopType==='Receiver'"> Parcel ID: {{getParcelData(stop.id)}}</p>
            <p *ngIf="address[4]==='false'"> Time frame: 4 pm - 6 pm</p>-->
            <!-- TODO Timer/ TimeSlots -->
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
